<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login</title>
</head>
<body>

<center>

<h2>Login</h2>

<form id="loginForm">

<input type="text" id="loginId" placeholder="Enter Email or Mobile" required><br><br>

<input type="password" id="password" placeholder="Enter Password" required><br><br>

<button type="submit">Login</button>

</form>

<p>New User? <a href="register.html">Register Here</a></p>
<hr>

    <p>Â© 2026 Civic Issue Reporting Tool</p>
</center>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";

import {
  getAuth,
  signInWithEmailAndPassword
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

import {
  getFirestore,
  collection,
  query,
  where,
  getDocs
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";


const firebaseConfig = {
  apiKey: "AIzaSyBpn16zqfxH_D4WwLtuAwDGQdQ3-qMsdCc",
  authDomain: "civic-issue-reporting-to-b6f3d.firebaseapp.com",
  projectId: "civic-issue-reporting-to-b6f3d",
  storageBucket: "civic-issue-reporting-to-b6f3d.firebasestorage.app",
  messagingSenderId: "442755472602",
  appId: "1:442755472602:web:d819b368244377072f59e3"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);


document.getElementById("loginForm").addEventListener("submit", async (e) => {

  e.preventDefault();

  let loginId = document.getElementById("loginId").value;
  let password = document.getElementById("password").value;

  let email = loginId;

  // ðŸ“Œ à¤…à¤—à¤° mobile dala hai
  if (!loginId.includes("@")) {

    const q = query(collection(db, "users"), where("mobile", "==", loginId));

    const querySnapshot = await getDocs(q);

    if (querySnapshot.empty) {
      alert("Mobile number not registered âŒ");
      return;
    }

    querySnapshot.forEach((doc) => {
      email = doc.data().email;
    });

  }

  // ðŸ” Login
  signInWithEmailAndPassword(auth, email, password)
    .then(() => {

      alert("Login Successful âœ…");
      window.location.href = "dashboard.html";

    })
    .catch((error) => alert(error.message));

});

</script>

</body>
</h>

   