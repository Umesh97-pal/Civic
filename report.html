<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Report Issue</title>
</head>

<body>

<center>

<h2>Report Civic Issue</h2>

<!-- Form fields with proper IDs for Firebase -->
<input type="text" id="name" placeholder="Enter Your Full Name" required><br><br>

<input type="text" id="mobile" placeholder="Enter Your Mobile Number" required><br><br>

<input type="text" id="title" placeholder="Issue Title" required><br><br>

<select id="category" required>
  <option value="">Select Category</option>
  <option>Road Damage</option>
  <option>Garbage Issue</option>
  <option>Water Problem</option>
  <option>Street Light</option>
  <option>Electricity</option>
</select>

<br><br>

<textarea id="description" placeholder="Description" rows="4" cols="30" required></textarea>

<br><br>

<input type="text" id="location" placeholder="Location" required><br><br>

<label>Upload Image</label><br><br>
<input type="file" id="image"><br><br>

<button type="button" onclick="submitComplaint()">Submit Complaint</button>

<br>
<h3 id="msg" style="color:green;"></h3>


<button><a href="index.html">Back</a></button>
<hr>

    <p>© 2026 Civic Issue Reporting Tool</p>
</center>

<!-- Firebase JS + Firestore -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyBpn16zqfxH_D4WwLtuAwDGQdQ3-qMsdCc",
  authDomain: "civic-issue-reporting-to-b6f3d.firebaseapp.com",
  projectId: "civic-issue-reporting-to-b6f3d",
  storageBucket: "civic-issue-reporting-to-b6f3d.firebasestorage.app",
  messagingSenderId: "442755472602",
  appId: "1:442755472602:web:d819b368244377072f59e3"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.submitComplaint = async function() {
  const name = document.getElementById("name").value;
  const mobile = document.getElementById("mobile").value;
  const title = document.getElementById("title").value;
  const category = document.getElementById("category").value;
  const description = document.getElementById("description").value;
  const location = document.getElementById("location").value;

  try {
    await addDoc(collection(db, "complaints"), {
      name: name,
      mobile: mobile,
      title: title,
      category: category,
      description: description,
      location: location,
      status: "Pending",
      date: new Date()
    });

    document.getElementById("msg").innerHTML = "Report issue successfully ✅";

    // Clear form after submit
    document.getElementById("name").value = "";
    document.getElementById("mobile").value = "";
    document.getElementById("title").value = "";
    document.getElementById("category").value = "";
    document.getElementById("description").value = "";
    document.getElementById("location").value = "";
    document.getElementById("image").value = "";

  } catch (error) {
    alert("Error: " + error.message);
  }
}

</script>

</body>
</h>